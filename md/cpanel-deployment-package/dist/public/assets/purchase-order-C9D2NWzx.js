import{af as N,aq as g,r as p,n as w,ae as y,j as e,a4 as v,ag as b,B as m,U as k,X as C,ah as P}from"./index-DSPCxSv1.js";const E=({title:d,children:r})=>e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:d})}),r&&e.jsx("div",{className:"flex gap-2",children:r})]}),O=()=>e.jsx("div",{className:"flex flex-col items-center justify-center h-full min-h-[70vh] p-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center max-w-lg",children:[e.jsx("div",{className:"bg-red-100 p-4 rounded-full mb-6",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-20 w-20 text-red-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),e.jsx("line",{x1:"16.5",y1:"7.5",x2:"7.5",y2:"16.5"}),e.jsx("line",{x1:"7.5",y1:"7.5",x2:"16.5",y2:"16.5"})]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-lg text-gray-600 mb-6",children:"You don't have permission to view this page. Please contact your administrator if you believe this is an error."}),e.jsx(m,{className:"bg-primary-600 hover:bg-primary-700 text-white",onClick:()=>window.location.href="/",children:"Return to Dashboard"})]})}),T=({isOpen:d,onClose:r,onSave:l})=>{const[t,x]=p.useState(null),i=p.useRef(null);if(!d)return null;const c=a=>{a.target.files&&a.target.files.length>0&&x(a.target.files[0])},o=()=>{i.current&&i.current.click()},h=()=>{t&&l(t)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Upload Purchase Order"}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:e.jsx(C,{size:20})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File*"}),e.jsx("input",{type:"file",ref:i,onChange:c,accept:".pdf,.doc,.docx,.xls,.xlsx,.csv",className:"hidden"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{variant:"outline",className:"mr-2",onClick:o,children:"Choose File"}),e.jsx("span",{className:"text-sm text-gray-500",children:t?t.name:"No file chosen"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{className:"bg-[#0076a8] hover:bg-[#00608a] text-white",onClick:h,disabled:!t,children:"Save"})})]})})};function S(){const{currentUser:d}=N(),{hasPermission:r}=g(),[l,t]=p.useState(0),x=10,[i,c]=p.useState(!1),{toast:o}=w(),h=y();if(!r("purchaseOrder"))return e.jsx(O,{});const{data:a=[],isLoading:R}=v({queryKey:["/api/purchase-orders"],queryFn:()=>P("GET","/api/purchase-orders").then(s=>s.json())}),u=b({mutationFn:async s=>{const n=new FormData;return n.append("file",s),(await fetch("/api/purchase-orders/upload",{method:"POST",body:n})).json()},onSuccess:()=>{h.invalidateQueries({queryKey:["/api/purchase-orders"]}),o({title:"Success",description:"Purchase order uploaded successfully"}),c(!1)},onError:s=>{o({title:"Error",description:s.message||"Failed to upload purchase order",variant:"destructive"})}}),j=()=>{c(!0)},f=s=>{u.mutate(s)};return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsx(E,{title:"Purchase Order"}),e.jsxs("div",{className:"bg-background-50 shadow-sm rounded-lg p-6 mt-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(m,{className:"bg-[#0076a8] hover:bg-[#00608a] text-white",onClick:j,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Upload PO"]})}),e.jsx(T,{isOpen:i,onClose:()=>c(!1),onSave:f}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#0076a8] text-white",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider w-12",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"GEM CONTRACT NO"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"ORGANIZATION NAME"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"PRODUCT NAME"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"BRAND"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"MODEL"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"ORDERED QUANTITY"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"UNIT PRICE"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"TOTAL PRICE"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"START DATE"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"EPBG PERCENTAGE"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"GENERATED DATE"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"STATUS"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"ACTION"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:14,className:"px-4 py-8 text-center text-gray-500",children:"No data found"})}):a.map((s,n)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n+1}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.gemContractNo}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.organizationName}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.productName}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.brand}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.model}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.orderedQuantity}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.unitPrice}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.totalPrice}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.startDate}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.epbgPercentage}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.generatedDate}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.status}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:"View"})})]},n))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"Show"}),e.jsxs("select",{className:"border border-gray-300 rounded px-2 py-1 text-sm",value:x,onChange:s=>{},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm",children:["Page ",l+1]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>t(Math.max(0,l-1)),disabled:l===0,className:"p-1 rounded border border-gray-300 disabled:opacity-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>t(l+1),disabled:a.length<x,className:"p-1 rounded border border-gray-300 disabled:opacity-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]})]})]})]})}export{S as default};
