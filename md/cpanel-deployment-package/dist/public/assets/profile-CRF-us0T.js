import{af as D,n as E,r as m,ag as K,j as s,C as L,o as R,p as B,q as G,ar as Y,as as $,at as O,au as T,L as n,I as i,B as h,X as z,y as C,av as H,am as V,ah as X}from"./index-DSPCxSv1.js";function Q(){var I,S;const{currentUser:e,refreshUser:P}=D(),{toast:c}=E(),[j,p]=m.useState(!1),[o,f]=m.useState(!1),[l,u]=m.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[x,g]=m.useState(!1),[t,k]=m.useState({}),[d,v]=m.useState({firstName:((I=e==null?void 0:e.name)==null?void 0:I.split(" ")[0])||"Poonam",lastName:((S=e==null?void 0:e.name)==null?void 0:S.split(" ")[1])||"Amale",email:(e==null?void 0:e.email)||"poonam@starinxs.com",contactNo:(e==null?void 0:e.phone)||"9673701295",address:(e==null?void 0:e.address)||"Krishna Green, Kolar Road",loginUserId:(e==null?void 0:e.username)||"poonam@123",city:(e==null?void 0:e.city)||"Bhopal",state:(e==null?void 0:e.state)||"Madhya Pradesh",designation:(e==null?void 0:e.designation)||"Finance Executive",department:(e==null?void 0:e.department)||"Admin",role:(e==null?void 0:e.role)||"Admin",userType:"Internal"});m.useEffect(()=>{var a,r;e&&v({firstName:((a=e.name)==null?void 0:a.split(" ")[0])||"Poonam",lastName:((r=e.name)==null?void 0:r.split(" ").slice(1).join(" "))||"Amale",email:e.email||"poonam@starinxs.com",contactNo:e.phone||"9673701295",address:e.address||"Krishna Green, Kolar Road",loginUserId:e.username||"poonam@123",city:e.city||"Bhopal",state:e.state||"Madhya Pradesh",designation:e.designation||"Finance Executive",department:e.department||"Admin",role:e.role||"Admin",userType:"Internal"})},[e]);const y=a=>{const{name:r,value:b}=a.target;u({...l,[r]:b})},M=()=>{const a={};return l.oldPassword||(a.oldPassword="Old password is required"),l.newPassword?l.newPassword.length<6&&(a.newPassword="Password must be at least 6 characters"):a.newPassword="New password is required",l.newPassword!==l.confirmPassword&&(a.confirmPassword="Passwords do not match"),k(a),Object.keys(a).length===0},w=a=>{const{name:r,value:b}=a.target;v({...d,[r]:b})},N=K({mutationFn:async a=>await(await X("PUT",`/api/users/${e==null?void 0:e.id}`)).json(),onSuccess:()=>{c({title:"Profile Updated",description:"Your profile information has been updated successfully."}),f(!1),P()},onError:a=>{c({title:"Update Failed",description:a.message||"Failed to update profile. Please try again.",variant:"destructive"})}}),A=()=>{const a={name:`${d.firstName} ${d.lastName}`,email:d.email,phone:d.contactNo,address:d.address,city:d.city,state:d.state};N.mutate(a)},F=()=>{var a,r;o&&v({firstName:((a=e==null?void 0:e.name)==null?void 0:a.split(" ")[0])||"Poonam",lastName:((r=e==null?void 0:e.name)==null?void 0:r.split(" ").slice(1).join(" "))||"Amale",email:(e==null?void 0:e.email)||"poonam@starinxs.com",contactNo:(e==null?void 0:e.phone)||"9673701295",address:(e==null?void 0:e.address)||"Krishna Green, Kolar Road",loginUserId:(e==null?void 0:e.username)||"poonam@123",city:(e==null?void 0:e.city)||"Bhopal",state:(e==null?void 0:e.state)||"Madhya Pradesh",designation:(e==null?void 0:e.designation)||"Finance Executive",department:(e==null?void 0:e.department)||"Admin",role:(e==null?void 0:e.role)||"Admin",userType:"Internal"}),f(!o)},q=async a=>{a.preventDefault(),M()&&(g(!0),setTimeout(()=>{g(!1),p(!1),u({oldPassword:"",newPassword:"",confirmPassword:""}),c({title:"Password Updated",description:"Your password has been updated successfully."})},1500))};return s.jsxs("div",{className:"container mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Profile"}),s.jsx("p",{className:"text-gray-600",children:"Manage your profile information"})]}),s.jsxs(L,{children:[s.jsx(R,{children:s.jsx(B,{children:"Profile Information"})}),s.jsx(G,{children:s.jsxs(Y,{defaultValue:"personal",className:"w-full",children:[s.jsxs($,{className:"mb-4",children:[s.jsx(O,{value:"personal",children:"Personal Information"}),s.jsx(O,{value:"company",children:"Company Information"})]}),s.jsx(T,{value:"personal",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(n,{htmlFor:"firstName",children:"First Name"}),s.jsx(i,{id:"firstName",name:"firstName",value:d.firstName,onChange:w,readOnly:!o})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"lastName",children:"Last Name"}),s.jsx(i,{id:"lastName",name:"lastName",value:d.lastName,onChange:w,readOnly:!o})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"email",children:"Email ID"}),s.jsx(i,{id:"email",name:"email",value:d.email,onChange:w,readOnly:!o})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"contactNo",children:"Contact No"}),s.jsx(i,{id:"contactNo",name:"contactNo",value:d.contactNo,onChange:w,readOnly:!o})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"loginUserId",children:"Login User ID"}),s.jsx(i,{id:"loginUserId",name:"loginUserId",value:d.loginUserId,readOnly:!0})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"state",children:"State"}),s.jsx(i,{id:"state",name:"state",value:d.state,onChange:w,readOnly:!o})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"city",children:"City"}),s.jsx(i,{id:"city",name:"city",value:d.city,onChange:w,readOnly:!o})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(n,{htmlFor:"address",children:"Address"}),s.jsx(i,{id:"address",name:"address",value:d.address,onChange:w,readOnly:!o})]}),o?s.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 mt-4",children:[s.jsxs(h,{variant:"outline",onClick:F,className:"flex items-center",children:[s.jsx(z,{className:"mr-2 h-4 w-4"}),"Cancel"]}),s.jsx(h,{onClick:A,className:"bg-[#0076a8] hover:bg-[#005e86] flex items-center",disabled:N.isPending,children:N.isPending?s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(H,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]}):s.jsx("div",{className:"md:col-span-2 flex justify-end mt-4",children:s.jsxs(h,{onClick:F,className:"bg-[#0076a8] hover:bg-[#005e86] flex items-center",children:[s.jsx(V,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})})]})}),s.jsx(T,{value:"company",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(n,{children:"Designation"}),s.jsx(i,{value:d.designation,readOnly:!0})]}),s.jsxs("div",{children:[s.jsx(n,{children:"Department"}),s.jsx(i,{value:d.department,readOnly:!0})]}),s.jsxs("div",{children:[s.jsx(n,{children:"Role"}),s.jsx(i,{value:d.role,readOnly:!0})]}),s.jsxs("div",{children:[s.jsx(n,{children:"User Type"}),s.jsx(i,{value:d.userType,readOnly:!0})]})]})})]})})]}),j&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 overflow-y-auto",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6 m-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Change Password"}),s.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:"×"})]}),s.jsxs("form",{onSubmit:q,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(n,{htmlFor:"oldPassword",children:"Current Password"}),s.jsx(i,{id:"oldPassword",name:"oldPassword",type:"password",value:l.oldPassword,onChange:y,className:t.oldPassword?"border-red-500":""}),t.oldPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.oldPassword})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"newPassword",children:"New Password"}),s.jsx(i,{id:"newPassword",name:"newPassword",type:"password",value:l.newPassword,onChange:y,className:t.newPassword?"border-red-500":""}),t.newPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.newPassword})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"confirmPassword",children:"Confirm Password"}),s.jsx(i,{id:"confirmPassword",name:"confirmPassword",type:"password",value:l.confirmPassword,onChange:y,className:t.confirmPassword?"border-red-500":""}),t.confirmPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.confirmPassword})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(h,{type:"button",variant:"outline",onClick:()=>p(!1),disabled:x,children:"Cancel"}),s.jsx(h,{type:"submit",className:"bg-[#0076a8] hover:bg-[#005e86]",disabled:x,children:x?s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Change Password"})]})]})]})})]})}function W(){const{toast:e}=E(),[P,c]=m.useState(!1),[j,p]=m.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[o,f]=m.useState(!1),l=x=>{const{name:g,value:t}=x.target;p({...j,[g]:t})},u=async x=>{x.preventDefault(),f(!0),setTimeout(()=>{f(!1),c(!1),p({oldPassword:"",newPassword:"",confirmPassword:""}),e({title:"Password Updated",description:"Your password has been updated successfully."})},1500)};return s.jsxs(s.Fragment,{children:[s.jsx(h,{onClick:()=>c(!0),variant:"outline",className:"w-full justify-start px-2 gap-2",children:"Change Password"}),P&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6 m-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Change Password"}),s.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:"×"})]}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(n,{htmlFor:"oldPassword",children:"Current Password"}),s.jsx(i,{id:"oldPassword",name:"oldPassword",type:"password",value:j.oldPassword,onChange:l,required:!0})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"newPassword",children:"New Password"}),s.jsx(i,{id:"newPassword",name:"newPassword",type:"password",value:j.newPassword,onChange:l,required:!0})]}),s.jsxs("div",{children:[s.jsx(n,{htmlFor:"confirmPassword",children:"Confirm Password"}),s.jsx(i,{id:"confirmPassword",name:"confirmPassword",type:"password",value:j.confirmPassword,onChange:l,required:!0})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(h,{type:"button",variant:"outline",onClick:()=>c(!1),disabled:o,children:"Cancel"}),s.jsx(h,{type:"submit",className:"bg-[#0076a8] hover:bg-[#005e86]",disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Change Password"})]})]})]})})]})}export{W as ChangePasswordModal,Q as default};
